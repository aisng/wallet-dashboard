<h1>Ethereum Dashboard</h1>

<%= form_with url: dashboard_search_path, method: :post, data: { turbo_frame: "result" } do |form| %>
  <div>
    <%= form.label :wallet_address, "EVM Wallet Address:" %><br>
    <%= form.text_field :wallet_address, size: 42 %>
  </div>

  <div style="margin-top: 10px; display: flex; align-items: flex-end; gap: 10px;">
    <div>
      <%= form.label :chain, "Select Chain:" %><br>
      <%= form.select :chain, @available_chains, { selected: @selected_chain } %>
    </div>

    <div>
      <%= form.label :block_number, "Block Number:" %><br>
      <%= form.number_field :block_number, style: "width: 100px;" %>
    </div>

    <% block_by_number =
      @rpc_methods.find { |method| method[:method] == "eth_getBlockByNumber" } %>
    <% if block_by_number %>
      <div>
        <%= button_tag block_by_number[:label],
        type: :submit,
        name: "rpc_method",
        value: block_by_number[:method],
        style: "margin-top: 24px;" %>
      </div>
    <% end %>
  </div>

  <div style="margin-top: 10px;">
    <%= form.check_box :testnet, {}, "true", "false" %>
    <%= form.label :testnet, "Use Testnet" %>
  </div>

  <div style="margin-top: 20px;">
    <% @rpc_methods.reject { |method| method[:method] == 'eth_getBlockByNumber' }.each do |method| %>
      <%= button_tag method[:label],
      type: :submit,
      name: "rpc_method",
      value: method[:method],
      style: "margin-right: 5px;" %>
    <% end %>
  </div>
<% end %>

<turbo-frame id="result">
  <% if @result.present? %>
    <h2>Result:</h2>
    <pre><%= h @result %></pre>
  <% end %>
</turbo-frame>
